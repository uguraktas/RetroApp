---
title: Authentication
description: Secure authentication with Better Auth
---

## Authentication System

CodeBaseHub uses Better Auth for a comprehensive authentication solution.

### Features

<Cards>
  <Card title="Email & Password" icon="FileCode">
    Traditional email/password authentication with secure password hashing.
  </Card>

  <Card title="OAuth Providers" icon="Globe">
    Sign in with GitHub, Google, and other OAuth providers.
  </Card>

  <Card title="Two-Factor Auth" icon="Settings">
    Optional 2FA support for enhanced security.
  </Card>

  <Card title="Session Management" icon="Zap">
    Secure session handling with JWT tokens.
  </Card>
</Cards>

### Setup

<Tabs items={['Configuration', 'Client', 'Server']}>
  <Tab value="Configuration">
    ```tsx title="lib/auth.ts"
    import { betterAuth } from "better-auth";
    import { db } from "./db";

    export const auth = betterAuth({
      database: db,
      emailAndPassword: {
        enabled: true,
      },
      socialProviders: {
        github: {
          clientId: process.env.GITHUB_CLIENT_ID!,
          clientSecret: process.env.GITHUB_CLIENT_SECRET!,
        },
        google: {
          clientId: process.env.GOOGLE_CLIENT_ID!,
          clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
        },
      },
      session: {
        expiresIn: 60 * 60 * 24 * 7, // 7 days
      },
    });
    ```
  </Tab>

  <Tab value="Client">
    ```tsx title="components/login-form.tsx"
    import { useAuth } from "@/hooks/use-auth";

    export function LoginForm() {
      const { signIn } = useAuth();

      const handleSubmit = async (e: React.FormEvent) => {
        e.preventDefault();
        await signIn.email({
          email: "user@example.com",
          password: "password",
        });
      };

      return <form onSubmit={handleSubmit}>...</form>;
    }
    ```
  </Tab>

  <Tab value="Server">
    ```tsx title="app/api/protected/route.ts"
    import { auth } from "@/lib/auth";
    import { NextRequest, NextResponse } from "next/server";

    export async function GET(request: NextRequest) {
      const session = await auth.getSession();

      if (!session?.user) {
        return NextResponse.json(
          { error: "Unauthorized" },
          { status: 401 }
        );
      }

      return NextResponse.json({ user: session.user });
    }
    ```
  </Tab>
</Tabs>

### Protected Routes

<Steps>
  <Step>
    ### Create Middleware

    ```tsx title="middleware.ts"
    import { auth } from "@/lib/auth";
    import { NextResponse } from "next/server";

    export async function middleware(request: Request) {
      const session = await auth.getSession();

      if (!session?.user) {
        return NextResponse.redirect(new URL("/login", request.url));
      }

      return NextResponse.next();
    }

    export const config = {
      matcher: ["/dashboard/:path*"],
    };
    ```
  </Step>

  <Step>
    ### Server Components

    ```tsx title="app/dashboard/page.tsx"
    import { auth } from "@/lib/auth";
    import { redirect } from "next/navigation";

    export default async function DashboardPage() {
      const session = await auth.getSession();

      if (!session?.user) {
        redirect("/login");
      }

      return <div>Dashboard for {session.user.name}</div>;
    }
    ```
  </Step>
</Steps>

<Callout type="info">
Better Auth automatically handles CSRF protection and secure session storage.
</Callout>
